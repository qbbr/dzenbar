#!/usr/bin/env bash

. .dzenbarrc

MONITOR=${1}
PIPE_LINE=${2}

while true; do
	CACHE=$(acpi -b)
	STATUS=$(echo ${CACHE} | cut -d ' ' -f 3 | tr -d [,])
	PERCENT=$(echo ${CACHE} | cut -d ' ' -f 4 | tr -d [,])

	if [[ "${STATUS}" = "Discharging" ]]; then
		STATUS=$(textColor "[-]")
	elif [[ "${STATUS}" = "Charging" ]]; then
		STATUS=$(textColor "[+]")
	else
		STATUS="" # Full
	fi

	putLineToPipeFile ${MONITOR} ${PIPE_LINE} " $(iconColor 'battery') ${PERCENT} ${STATUS}"
	sleep ${BATTERY_UPDATE}
done
